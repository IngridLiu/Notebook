# String：字符串的处理

<br>
<br>
<br>

| http://python3-cookbook-personal.readthedocs.io/zh_CN/latest/chapters/p02_strings_and_text.html#

## 1 字符串的格式化

### 1.1使用format()格式化字符串
```
'{0}, {1}, {2}'.format('a', 'b', 'c')
#'a, b, c'
'{}, {}, {}'.format('a', 'b', 'c')  # 3.1+ only
#'a, b, c'
'{2}, {1}, {0}'.format('a', 'b', 'c')
#'c, b, a'
'{2}, {1}, {0}'.format(*'abc')      # unpacking argument sequence
#'c, b, a'
'{0}{1}{0}'.format('abra', 'cad')   # arguments' indices can be repeated
#'abracadabra'

```

<br>

## 5 字符串搜索和替换

### 5.1 问题

&emsp;&emsp;你想在字符串中搜索和匹配指定的文本模式

### 5.2 解决方案

&emsp;&emsp;对于简单的字面模式，直接使用 str.repalce() 方法即可，比如：
```
>>> text = 'yeah, but no, but yeah, but no, but yeah'
>>> text.replace('yeah', 'yep')
'yep, but no, but yep, but no, but yep'
>>>
```
&emsp;&emsp;对于复杂的模式，请使用 re 模块中的 sub() 函数。 为了说明这个，假设你想将形式为 11/27/2012 的日期字符串改成 2012-11-27 。示例如下：
```
>>> text = 'Today is 11/27/2012. PyCon starts 3/13/2013.'
>>> import re
>>> re.sub(r'(\d+)/(\d+)/(\d+)', r'\3-\1-\2', text)
'Today is 2012-11-27. PyCon starts 2013-3-13.'
>>>

```

&emsp;&emsp;sub() 函数中的第一个参数是被匹配的模式，第二个参数是替换模式。反斜杠数字比如 \3 指向前面模式的捕获组号。

&emsp;&emsp;如果你打算用相同的模式做多次替换，考虑先编译它来提升性能。比如：
```
>>> import re
>>> datepat = re.compile(r'(\d+)/(\d+)/(\d+)')
>>> datepat.sub(r'\3-\1-\2', text)
'Today is 2012-11-27. PyCon starts 2013-3-13.'
>>>
```

&emsp;&emsp;对于更加复杂的替换，可以传递一个替换回调函数来代替，比如：

```
>>> from calendar import month_abbr
>>> def change_date(m):
... mon_name = month_abbr[int(m.group(1))]
... return '{} {} {}'.format(m.group(2), mon_name, m.group(3))
...
>>> datepat.sub(change_date, text)
'Today is 27 Nov 2012. PyCon starts 13 Mar 2013.'
>>>
```

&emsp;&emsp;一个替换回调函数的参数是一个 match 对象，也就是 match() 或者 find() 返回的对象。 使用 group() 方法来提取特定的匹配部分。回调函数最后返回替换字符串。

&emsp;&emsp;如果除了替换后的结果外，你还想知道有多少替换发生了，可以使用 re.subn() 来代替。比如：

```
>>> newtext, n = datepat.subn(r'\3-\1-\2', text)
>>> newtext
'Today is 2012-11-27. PyCon starts 2013-3-13.'
>>> n
2
>>>
```

### 5.3 讨论

&emsp;&emsp;关于正则表达式搜索和替换，上面演示的 sub() 方法基本已经涵盖了所有。 其实最难的部分就是编写正则表达式模式，这个最好是留给读者自己去练习了。


<br>

## 11 删除字符串中不需要的字符
### 11.1 问题

&emsp;&emsp;你想去掉文本字符串开头，结尾或者中间不想要的字符，比如空白。

### 11.2 解决方案

&emsp;&emsp;strip() 方法能用于删除开始或结尾的字符。 lstrip() 和 rstrip() 分别从左和从右执行删除操作。 默认情况下，这些方法会去除空白字符，但是你也可以指定其他字符。比如：

```
>>> # Whitespace stripping
>>> s = ' hello world \n'
>>> s.strip()
'hello world'
>>> s.lstrip()
'hello world \n'
>>> s.rstrip()
' hello world'
>>>
>>> # Character stripping
>>> t = '-----hello====='
>>> t.lstrip('-')
'hello====='
>>> t.strip('-=')
'hello'
>>>

```
### 11.2 讨论

&emsp;&emsp;这些 strip() 方法在读取和清理数据以备后续处理的时候是经常会被用到的。 比如，你可以用它们来去掉空格，引号和完成其他任务。

&emsp;&emsp;但是需要注意的是去除操作不会对字符串的中间的文本产生任何影响。比如：

```
>>> s = ' hello     world \n'
>>> s = s.strip()
>>> s
'hello     world'
>>>


```
&emsp;&emsp;如果你想处理中间的空格，那么你需要求助其他技术。比如使用 replace() 方法或者是用正则表达式替换。示例如下：

```
>>> s.replace(' ', '')
'helloworld'
>>> import re
>>> re.sub('\s+', ' ', s)
'hello world'
>>>

```

&emsp;&emsp;通常情况下你想将字符串 strip 操作和其他迭代操作相结合，比如从文件中读取多行数据。 如果是这样的话，那么生成器表达式就可以大显身手了。比如：

```
with open(filename) as f:
    lines = (line.strip() for line in f)
    for line in lines:
        print(line)

```

&emsp;&emsp;在这里，表达式 lines = (line.strip() for line in f) 执行数据转换操作。 这种方式非常高效，因为它不需要预先读取所有数据放到一个临时的列表中去。 它仅仅只是创建一个生成器，并且每次返回行之前会先执行 strip 操作。

&emsp;&emsp;对于更高阶的strip，你可能需要使用 translate() 方法。请参阅下一节了解更多关于字符串清理的内容。



