# 《基于深度学习的推荐系统》学习笔记



| 本文整理自论文《基于深度学习的推荐系统》
| 仅为整理出来自己参考
<br>

&emsp;&emsp;基于深度学习的推荐系统通常将各类用户和项目相关的数据作为输入，利用深度学习模型学习到用户和项目的隐表示，并基于这种隐表示为用户产生项目推荐。

&emsp;&emsp;一个基本的架构如图1所示，包含输入层、模型层和输出层。输入层的数据主要包括: 用户的显式反馈(评分、喜欢\不喜欢)或隐式反馈数据(浏览、点击等行为数据)、用户画像(性别、年龄、喜好等)和项目内容(文本、图像等描述或 内容)数据、用户生成内容(社会化关系、标注、 评论等辅助数据)。在模型层，使用的深度学习模型比较广泛，包括自编码器、受限玻尔兹曼机、卷积神经网络、循环神经网络等。在输出层，通过利用学习到的用户和项目隐表示，通过内积、Softmax、 相似度计算等方法产生项目的推荐列表。

![图1:基于深度学习的推荐系统的基本框架](https://upload-images.jianshu.io/upload_images/10947003-82da59bc1eca9470.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400)

<br>

## 1. 深度学习在基于内容的推荐系统中的应用

- ###### 优点：

&emsp;&emsp;通过端到端的过程学习到数据的特征，自动获取到数据的高层次表示，而不依赖于人工设计特征。

- ###### 应用：

&emsp;&emsp;1. 从项目的内容信息中提取项目的隐表示。

&emsp;&emsp;2. 从用户的画像信息及历史行为数据中获取用户的隐表示。

### 1.1 基于多层感知机的方法

#### 1.1.1 深度结构化语义模型

- ###### Paper：

&emsp;&emsp;[Learning deep structured semantic models for web search using clickthrough data](http://delivery.acm.org/10.1145/2510000/2505665/p2333-he.pdf?ip=202.114.2.108&id=2505665&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522668161_90789821cdce96f8d57593ad0fb045d5)

##### 1.1.1.1 多视角深度神经网络模型（Multi-View Deep Neural Network, Mutil-View DNN）

- ###### Paper:

&emsp;&emsp;[A multi-view deep learning approach for cross domain user modeling in recommendation systems](http://delivery.acm.org/10.1145/2750000/2741667/p278-elkahky.pdf?ip=202.114.2.108&id=2741667&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522668346_7e8e50f88ccb5c6acee8f835145ea7d1)

- ######  基本思想：

&emsp;&emsp; Mutil-View DNN扩展了深度结构化语义模型（Deep Structured Semantic Mpdels，DSSM），设置两类映射通路，分别通过深度学习模型将两类信息实体映射到同一隐空间，在这个隐含空间中通过余弦相似度计算两个实体的匹配度，然后根据匹配度产生推荐。

##### 1.1.1.2  深度协作神经网络模型（Deep Cooperative Neural Network，DeepCoNN）

- ###### Paper:

&emsp;&emsp;[Joint deep modeling of users and items using reviews for recommendation](http://delivery.acm.org/10.1145/3020000/3018665/p425-zheng.pdf?ip=202.114.2.108&id=3018665&acc=CHORUS&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E6D218144511F3437&__acm__=1522668600_f4ad4ab373f5bb4387e979dc3b7698b1)

- ###### 基本思想：

&emsp;&emsp;利用两个并行的神经网络模型学习用户和项目的隐特征，一个网络通过用户的所有评论数据建模了用户的偏好，另一个网络通过项目的所有评论信息建模了项目的特征，然后在两个神经网络上面构建一个交互层来预测用户对项目的评分。

##### 1.1.1.3 标签感知的个性化推荐问题

- ###### Paper：

&emsp;&emsp;[Tag-Aware Personalized Recommendation Using a Deep-Semantic Similarity Model with Negative Sampling](http://delivery.acm.org/10.1145/2990000/2983874/p1921-xu.pdf?ip=202.114.2.108&id=2983874&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522669635_18c4066c44644ba715d76380455ea7e7)

- ###### 基本思想：

&emsp;&emsp;分别利用用户的所有标签和项目的所有标签定义用户和项目的输入特征，来帮助学习用户和项目的隐表示，通过计算用户隐表示和项目隐表示来产生推荐。

##### 1.1.1.4 位置感知的个性化新闻推荐问题

- ###### Paper：

&emsp;&emsp;[Location-Aware Personalized News

Recommendation With Deep Semantic Analysis](http://ieeexplore.ieee.org/document/7823033/#full-text-section)

- ###### 基本思想：

&emsp;&emsp;通过DSSM中添加一个位置通道，利用MLP从用户信息、项目信息和位置局部主题分布中学习用户、项目和位置的隐表示。然后联合三个方面的信息计算特定位置下用户兴趣与新闻内容之间的关联度来产生新闻推荐。

<br>

#### 1.1.2 深广学习模型

##### 1.1.2.1 深广学习（ Wide&Deep Learning）模型

- ###### Paper：

&emsp;&emsp;[Wide & deep learning for recommender systems](http://delivery.acm.org/10.1145/2990000/2988454/p7-cheng.pdf?ip=202.114.2.108&id=2988454&acc=OA&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E5945DC2EABF3343C&__acm__=1522671266_d272506b7024f3da130eb306667016c2)

- ###### 基本思想：

&emsp;&emsp;通过利用用户特征、情境特征和项目特征等多源异构数据，提出了一种深广学习（Wide&Deep Learning）模型。

&emsp;&emsp;该模型同时具有了高的记忆力（memorization）能力和泛化能力。记忆力主要依靠统计方法，通过关联学习分析历史记录中的共现现象，主要利用了相关性，不具有泛化性且需要手动特征工程。泛化需要研究关联的传递性，通过探索更多的信息能够提升推荐的多样性。（？？？没有特别懂）

&emsp;&emsp;如下图2展示了一个深广学习模型的通用示意图，这种模型联合训练一个宽广线性模型 (图中左侧) 和一个深度神经网络 (图中右侧) 来确保模型记忆能力和泛化能力的均衡。

![图2:深广学习模型](https://upload-images.jianshu.io/upload_images/10947003-d9b194408bb5fbc3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400)

- ###### 应用：

&emsp;&emsp;App推荐

##### 1.1.2.2  神经协同过滤方法（Neural Collaborative Filtering，NCF）

- ###### Paper：

&emsp;&emsp;2017 - [Neural Collaborative Filtering](http://delivery.acm.org/10.1145/3060000/3052569/p173-he.pdf?ip=202.114.2.108&id=3052569&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522717969_3ee09f9829d98475f89919af393506ec)

- ###### 基本思想：

&emsp;&emsp;将用户和项目的特征作为输入，利用多层神经网络学习用户和项目之间的交互函数。

##### 1.1.2.3 神经矩阵因子分解模型（Neural Matrix Factorization Model，NeuMF）

- ###### Paper：

&emsp;&emsp;2017 - [Neural Collaborative Filtering](http://delivery.acm.org/10.1145/3060000/3052569/p173-he.pdf?ip=202.114.2.108&id=3052569&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522717969_3ee09f9829d98475f89919af393506ec)

- ###### 基本思想：

&emsp;&emsp;通过将NCF结构实例化，得到一种矩阵因子分解的泛化结构和一种多层感知机结构，分别可以建模用户与项目之间交互的线性和非线性特征。最后在NCF框架下组合以上两种结构提出了神经矩阵因子分解模型（Neural Matrix Factorization Model，NeuMF）。

&emsp;&emsp;在建模用户与项目的交互中组合了矩阵因子分解的线性特征和深度神经网络的非线性特征。

<br>

#### 1.1.3 基于MLP的广告点击率预测

#####1.1.3.1 Deep Crossing模型

- ###### Paper：　

&emsp;&emsp;2016 - [Deep Crossing: Web-Scale Modeling without Manually Crafted Combinatorial Features](http://delivery.acm.org/10.1145/2940000/2939704/p255-shan.pdf?ip=202.114.2.108&id=2939704&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522719461_240976431636fab4a80e4a5b5b3b589b)

- ###### 基本思想：

&emsp;&emsp;Web领域中输入特征通常是离散和稀疏的，为了有效建模这类数据，学习特征之间的交互至关重要。Deep Crossing利用MLP（Mutil Layer Perception）直接学习特征之间的交互。

&emsp;&emsp;Deep Crossing的模型结构如图3所示，是由一个嵌入层、一个堆栈曾、一个残差单元和一个评分层组成的多层感知机。

![图3:Deep Crossing模型结构](http://upload-images.jianshu.io/upload_images/10947003-06c03cb56ede529d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400)

<br>

##### 1.1.3.2 Deep&Cross网络模型

- ###### Paper：

&emsp;&emsp;2017/08 -[Deep & Cross Network for Ad Click Predictions](https://arxiv.org/pdf/1708.05123.pdf)

- ###### 基本思想：

&emsp;&emsp;Deep&Cross同时在输入特征上采用一个深度网络（Deep Network）和交叉网络（Cross Network），然后组合两部分输出进行预测。

&emsp;&emsp;Deep&Cross集成了深度神经网络（DNN）和Deep Crossing的优点。

#####1.1.3.3 深度嵌入森林模型（Deep embedding Forest，DEF）

- ###### Paper：

&emsp;&emsp;2017 - [Deep Embedding Forest: Forest-based Serving with Deep Embedding Features](http://delivery.acm.org/10.1145/3100000/3098059/p1703-zhu.pdf?ip=202.114.2.108&id=3098059&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522719542_e6ca260b3386702cf874a851c0dcc115)

- ###### 基本思想：

&emsp;&emsp;将Deep Crossing中的残差单元替换为森林层，通过预训练能够降低模型的在线预测时间。

##### 1.1.3.4 深度兴趣网络（Deep Interest Network，DIN）

- ###### Paper：

&emsp;&emsp;2017/08 - [Deep Embedding Forest: Forest-based Serving with Deep Embedding Features](http://delivery.acm.org/10.1145/3100000/3098059/p1703-zhu.pdf?ip=202.114.2.108&id=3098059&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522720621_ea7bd0a91441887fc31249245e4ec8db)

- ###### 基本思想：

&emsp;&emsp;考虑到大部分点击率预测研究中缺乏对用户行为多样性和局部激活（Local Activiation）现象的建模，提出了一种深度兴趣网络（Deep Interest Network，DIN）。基于一种多层感知机结构，通过引入用户的兴趣分布和注意力机制实现对用户行为多样性和局部激活现象的建模。

##### 1.1.3.5 基于产品的神经网络模型（Product-based Neural Network，PNN）

- ###### Paper：

&emsp;&emsp;2016/12 - [Product-based neural networks for userresponse prediction](http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7837964)

- ###### 基本思想：

&emsp;&emsp;基于因子化机模型和MLP提出了一个基于产品的神经网络模型（Product-based Neural Network，PNN）。模型结构如图4所示，包括一个特征嵌入层、一个成对特征交互层和两个全链接层。

![图4:基于产品的神经网络模型](https://upload-images.jianshu.io/upload_images/10947003-23e9b39e4c2678c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600)

##### 1.1.3.6 基于深度网络的因子化机模型（Factorization-Machine based neural network，DeepFM）

- ###### Paper：

&emsp;&emsp;2017/04 - [DeepFM: A Factorization-Machine based Neural Network for CTR Prediction](https://arxiv.org/pdf/1703.04247.pdf)

- ###### 基本思想：

&emsp;&emsp; 基于Wide&Deep，结合因子化机和深度学习，提出了一种基于深度网络的因子化机模型（Factorization-Machine based neural network，DeepFM）进行点击率预测，分别采用因子机和深度神经网络建模低层次和高层次的特征交互，相比Wide&Deep，DeepFM不需要进行人工的特征工程处理。

##### 1.1.3.7 神经因子机模型（Neural Factorization Machine，NFM）

- ###### Paper：

&emsp;&emsp;2017/08 - [Neural Factorization Machines for Sparse Predictive Analytics](http://delivery.acm.org/10.1145/3090000/3080777/p355-he.pdf?ip=202.114.2.108&id=3080777&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522722631_8072f2aa31c31cfcb40756f60bbe21e1)

- ###### 基本思想：

&emsp;&emsp; 考虑稀疏数据输入的情况下的推荐问题，基于因子机模型提出了一种神经因子机模型（Neural Factorization Machine，NFM），能够实现特征之间的高层次非线性交互，从而提升预测能力。

&emsp;&emsp; 该模型与深广模型的最大区别是，在其特征嵌入层之上增加了一个双线性交互池化操作。相比深广学习模型，神经因子机模型在使用更少隐层的情况下获取到了更好预测性能，而且因为参数更少，训练更加容易。

##### 1.1.3.8 注意力因子化机模型（Attentional Factorization Machine，AFM）

- ###### Paper：

&emsp;&emsp;2017/08 - [Attentional Factorization Machines: Learning the Weight of Feature Interactions via Attention Networks](https://arxiv.org/pdf/1708.04617.pdfb)

- ###### 基本思想：

&emsp;&emsp; 通过扩展NFM模型，提出了一种注意力因子化机模型（Attentional Factorization Machine，AFM），通过将注意力机制引入双纤细交互池化操作中，提升了NFM的表示能力和可解释性。

#### 1.1.4 基于MLP的YouTube视频推荐方法

- ###### Paper：

&emsp;&emsp; 201609 - [Deep Neural Networks for YouTube Recommendations](https://dl.acm.org/citation.cfm?id=2959190)

- ###### 基本思想：

&emsp;&emsp; 通过利用用户信息、情境信息、历史行为数据和项目特征等多源异构数据，提出一种深度神经网络模型用于Youtube视频推荐。Youtube视频推荐主要面临三个方面的挑战：可扩展性、新鲜度和数据噪声问题。为了克服着三个挑战，该研究将深度神经网络模型应用到视频推荐系统的两个关键过程：后选集生成和排序。系统架构如图5所示。

![图5:基于 MLP 的 YouTube 视频推荐方法](https://upload-images.jianshu.io/upload_images/10947003-0f1560e68cede8e1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

&emsp;&emsp;候选集生成的目的是从海量视频库中筛选出和用户相关的几百个视频，主要利用用户在YouTube上的历史行为数据、用户特征和情境信息建模用户对视频的个性化偏好，其核心方法是将推荐转化为一个基于深度神经网络的分类问题，寻找与用户向量（神经网络变换后的特征向量）距离最近的N个视频。排序是通过进一步考虑更多的视频特征，利用神经网络和逻辑回归模型对每个候选视频进行打分，并根据打分值对视频做排序。

<br>

### 1.2 基于卷机神经网络（CNN）的方法

#### 1.2.1 基于注意力的CNN

##### 1.2.1.1 基于注意力的卷积神经网络

- ###### Paper：

&emsp;&emsp;2016 - [Hashtag Recommendation Using Attention-Based Convolutional Neural Network](https://www.ijcai.org/Proceedings/16/Papers/395.pdf)


- ###### 基本思想：

&emsp;&emsp;作者将Hashtag推荐作为一个多标记分类问题，CNN作为一种特征提取手段来获取微博的特征。提出的模型包括一个全局通道和一个局部注意力通道，全局通道由一个卷积层和一个Pooling层组成，局部注意力通道由一个注意力层和一个Pooling层组成。模型的架构如图6所示。

![图6:基于注意力的卷积神经网络](https://upload-images.jianshu.io/upload_images/10947003-eb266807509dc6ff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400)

#####1.2.1.2 利用多模信息来进行微博的hashtag推荐

- ###### Paper:

&emsp;&emsp;2017 -[Hashtag Recommendation for Multimodal Microblog Using Co-Attention Network](http://static.ijcai.org/proceedings-2017/0478.pdf)

- ###### 基本思想：

&emsp;&emsp;通过利用多模信息来进行微博的hashtag推荐。该工作考虑了文本和图像，分别采用CNN和RNN从图像和文本中提取特征，然后组合两个方面的特征进行标签推荐。同时，考虑到标签仅仅与图像和文本中的部分信息存在关联，该工作采用注意力机制来建模这种局部关联性。

##### 1.2.1.3 利用评论信息来进行推荐

- ###### Paper：

&emsp;&emsp;2017 - [Representation Learning of Users and Items for Review Rating Prediction Using Attention-based Convolutional Neural Network](https://pdfs.semanticscholar.org/4946/89f4522619b887e515aea2b205490b0eb5cd.pdf)

- ###### 基本思想：

&emsp;&emsp;该模型是一个基于注意力的模型，其包含一个用户网络和一个项目网络，分别采用CNN从用户的所有评论和项目的所有评论中学习用户和项目的隐表示，同时采用attention机制来建模评论中的不同部分与用户偏好和项目特征的关联度。

##### 1.2.1.4 动态注意力深度模型（Dynamic Attention Deep Model，DADM）

- ###### Paper：

&emsp;&emsp;2017/08 - [Dynamic Attention Deep Model for Article Recommendation by Learning Human Editors' Demonstration](http://delivery.acm.org/10.1145/3100000/3098096/p2051-wang.pdf?ip=202.114.2.108&id=3098096&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522737138_bcdaeada6f6f9e5d834c2e510f883d51)

- ###### 基本思想：

&emsp;&emsp;利用动态注意力深度模型（Dynamic Attention Deep Model，DADM）来研究编辑者的文章推荐问题，DADM利用CNN来学习文章的语义信息，同时利用attention机制来抓住编辑者选择文章行为的动态性。

<br>

#### 1.2.2 比较深度学习方法(Comparative Deep Learning,CDL)

- ###### Paper:

&emsp;&emsp;2016 - [Comparative Deep Learning of Hybrid Representations for Image Recommendations](http://openaccess.thecvf.com/content_cvpr_2016/papers/Lei_Comparative_Deep_Learning_CVPR_2016_paper.pdf)

- ###### 基本思想：

&emsp;&emsp;该论文基于深度学习方法研究了图像推荐问题。该研究指出图像推荐最重要的是需要在图像的语义理解与用户对图像的偏好或意图之间建立桥梁，因此学习到的图像表示不仅仅需要由高的表达性和可分类性，更重要的是反映用户对图像的偏好。

&emsp;&emsp;比较深度学习方(Comparative Deep Learning,CDL)，其主要思想是利用MLP和CNN分别从用户的多源异构数据（包括用户画像、标签信息等）和图像的视觉信息中学习用户和图像的隐表示，并将用户和图像映射到同一隐空间中。

&emsp;&emsp;CDL利用了比较学习的思想，即同时利用正反馈图像和负反馈图像，比较它们与用户之间的距离（即正反馈图像与用户的距离应该比负反馈图像与用户之间的距离要小），并采用交叉熵损失函数进行参数学习。最后通过计算用户和图像之间的距离来产生图像推荐。

<br>

#### 1.2.3 基于CNN的音乐推荐

- ###### Paper：

&emsp;&emsp;2013 - [Deep content-based music recommendation](http://papers.nips.cc/paper/5004-deep-content-based-music-recommendation.pdf)

- ###### 基本思想：

&emsp;&emsp;利用深度学习模型解决音乐推荐系统中的冷启动问题。在音乐推荐中，协同过滤常常面临冷启动的问题，即对于一些没有用户数据的音乐，往往不能够被推荐给用户。作者首先通过组合加权矩阵因子分解和卷积神经网络，将用户和音乐投影到一个共享的隐空间，从而能够学习到用户和歌曲的隐表示。对于新的歌曲，可以通过训练好的卷积神经网络从自身的音频信号中提取出歌曲的隐表示，从而能够在共享隐空间中通过计算用户与新音乐之间的相似性来为用户推荐音乐，从而帮助解决新项目的冷启动问题。

<br>

### 1.3 基于循环神经网络的方法

#### 1.3.1 基于注意力的RNN

#####1.3.1.1 基于注意力的RNN

- ###### Paper：

&emsp;&emsp;2016 - [Hashtag recommendation with topical attention-based LSTM](http://ink.library.smu.edu.sg/cgi/viewcontent.cgi?article=4437&context=sis_research)

- ###### 基本思想：

&emsp;&emsp;一种基于注意力的LSTM来进行微博中的hashtag推荐，注意力机制与RNN结合的优势是能够抓住文本的序列特征，同时能够从微博中识别最具有信息量的词。模型首先利用LSTM来学习微博的隐状态(h1,h2,...,hn），同时采用主题模型来学习微博的主题分布。模型架构如图7所示。

![基于注意力的RNN架构](https://upload-images.jianshu.io/upload_images/10947003-3ff1a9e9e97f592d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600)

##### 1.3.1.2 基于注意力的记忆网络进行hashtag推荐

- ###### Paper：

&emsp;&emsp;2016 - [Hashtag Recommendation Using End-To-End Memory Networks with Hierarchical Attention](http://www.aclweb.org/anthology/C16-1090)
 
- ###### 基本思想：

&emsp;&emsp;使用记忆网络（Memory Network）代替CNN和LSTM，提出了一个基于注意力的记忆网络来进行hashtag推荐。

##### 1.3.1.3 基于注意力的记忆网络进行微博的提示推荐

- ###### Paper：

&emsp;&emsp;2017 - [Mention Recommendation for Twitter with End-to-end Memory Network](http://static.ijcai.org/proceedings-2017/0260.pdf)

- ###### 基本思想：

&emsp;&emsp;考虑到微博长度通常很短，存在单词稀疏和单词同义问题，仅仅依靠语言模型（如词嵌入模型）会导致有限的推荐性能。作者通过利用用户的历史微博作为外部记忆单元来建模用户的兴趣，提升了提示推荐的准确性。具体地，作者利用两个记忆网络分别从作者的历史微博和目标用户的历史微博中发现作者和目标用户的兴趣，最后联合微博的内容、作者的兴趣和目标用户的兴趣实现微博用户提示推荐。

<br>

#### 1.3.2 基于RNN的新闻推荐

- ###### Paper:

&emsp;&emsp;2017/08 - [Embedding-based News Recommendation for Millions of Users](http://delivery.acm.org/10.1145/3100000/3098108/p1933-okura.pdf?ip=202.114.2.108&id=3098108&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522741233_386fdef0dd5d6a41205086f5e102c44d)

- ###### 基本思想：

&emsp;&emsp;采用深度学习的方法研究新闻推荐问题。首先为了抓住文章的语义信息，采用降噪自编码器（DAE）从新闻中提取文章的隐表示。然后为了学习用户的偏好，采用CNN从用户的历史行为列表中学习用户的隐表示。最后，为了利用用户与新闻之间的关联，基于新闻和用户的隐表示采用点乘的方式为用户产生新闻推荐列表。

<br>

### 1.4 基于深度信念网络的方法

#### 1.4.1 基于DBN的音乐推荐

- ###### Paper：

&emsp;&emsp;2014 - [Improving Content-based and Hybrid Music Recommendation using Deep Learning](http://delivery.acm.org/10.1145/2660000/2654940/p627-wang.pdf?ip=202.114.2.108&id=2654940&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522742348_ac869e996a4131837a22c8294cc49780)

- ###### 基本思想：

&emsp;&emsp;传统的基于内容的音乐推荐将音乐内容特征提取与音乐推荐分为两个独立的过程，这可能导致推荐性能的不足。通过深度信念网络和概率矩阵分解（Probabilistic Matrix Factorization，PMF）将两个过程组合到一个统一框架中，提升了音乐推荐的性能。具体地，首先学习两种用户和项目的隐表示，一种是利用概率矩阵分解学习到用户和项目的隐表示，第二种是采用深度信念网络提取的音乐特征表示以及由用户偏好得到的用户表示，然后利用两种隐表示分别做内积，并组合两种内积通过拟合用户-项目评分矩阵进行模型训练，最后基于学习到的两种表示对未知评分进行预测。

&emsp;&emsp;总的来说，深度学习能够有效缓解用户和项目特征提取困难，以及新项目的冷启动问题，同时能够将用户和项目特征提取与推荐过程融合到统一的框架中，但是并不能够解决基于内容的推荐方法自身存在的新用户问题，也不能为用户发现新的感兴趣的资源，只能发现与用户已有兴趣相似的资源。

<br>

<br>

## 2 深度学习在协同过滤中的应用

&emsp;&emsp;基于深度学习的协同过滤方法利用用户对项目的显式反馈或隐式反馈数据，采用深度学习训练一个推荐模型，是一类基于模型的协同过滤推荐方法。其主要思路是将用户的评分向量或项目的被评分向量作为输入，利用深度学习模型学习用户或项目的隐表示，然后利用逐点损失(point-wise loss) 和成对损失(pair-wise loss)等类型的损失函数构建目标优化函数对深度学习模型的参数进行优化，最后利用学习到的隐表示进行项目推荐。

###2.1 基于受限玻尔兹曼机的协同过滤方法

####2.1.1 基于RBM的协同过滤

- ###### Paper：

&emsp;&emsp;2007 - [Restricted Boltzmann machines for collaborative filtering](http://delivery.acm.org/10.1145/1280000/1273596/p791-salakhutdinov.pdf?ip=202.114.2.108&id=1273596&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522745486_09e01c450ed10018feaec4d395415d7f)

- ###### 基本思想：

&emsp;&emsp;2007年Salakhutdinov等人首次将深度学习应用于解决推荐问题，提出一 种基于受限玻尔兹曼机的协同过滤推荐模型。假设有 m 部电影，则使用m 个Softmax单元来作为可见单元构造RBM。每个用户都有一个单独的RBM，对于不同的RBM仅仅是可见单元不同，因为不同的用户会对相同的电影打分，因此所有的这些RBM的可见单元共享相同的偏置以及可见单元与隐层单元的连接权值W。Salakhutdinov等人对传统的RBM模型进行了改进，一是在可见层，评分数据通过一个固定长度的0-1向量进行表示;二是考虑到用户只 对很少的项目进行了评分，使用一种不与任何隐层 单元连接的Missing单元表示未评分的项目。为了考虑用户未评分的电影的信息，Salakhutdinov等人采用一个0-1向量 r 表示电影是否被评分过，通过融入这种辅助信息提出了一种条件RBM。

&emsp;&emsp;结构模型如图8所示：

![基于RBM的协调过滤方法的模型结构](https://upload-images.jianshu.io/upload_images/10947003-33079450e65870cb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600)

#### 2.1.2 改进的基于受限玻尔兹曼机的协同过滤推荐模型

- ###### Paper：

&emsp;&emsp;2009 - [Ordinal Boltzmann machines for collaborative filtering](http://delivery.acm.org/10.1145/1800000/1795178/p548-truyen.pdf?ip=202.114.2.108&id=1795178&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522746491_4baacfdb1b6041e6aebd6f69587e4db2)

- ###### 基本思想：

&emsp;&emsp;通过将Salakhutdinov等人的工作进行扩展，用于建模用户评分的序数特征，采用一种统一的方式同时抓住了相似性和共现性。

#### 2.1.3 改进的基于受限玻尔兹曼机的协同过滤推荐模型

- ###### Paper：

&emsp;&emsp;2013 - [A non-IID Framework for Collaborative Filtering with Restricted Boltzmann Machines](http://proceedings.mlr.press/v28/georgiev13.pdf)

- ###### 基本思想：

&emsp;&emsp;通过增加用户之间的关联，对RBM 模型进行了扩展，并且对模型的训练和预测过程进行了简化，同时还使得模型能够直接处理实值评分数据。

#### 2.1.4 基于实值状态的玻尔兹曼机

- ###### Paper：

&emsp;&emsp;2016 - Based-on real-valued conditional Restricted Boltzmann Machine and social network for collaborative filtering(中文)

- ###### 基本思想：

&emsp;&emsp;将RBM模型进行扩展，提出一 种基于实值状态的玻尔兹曼机，该模型从三个方面 对RBM进行改进，一是能够直接将评分数据作为可 见单元的状态，不再需要转化为 K 维的0-1向量表示，二是在训练数据中增加使用了未评分信息，是将好友信任关系融入到该模型之中，能够有效缓解模型的稀疏性。

<br>

&emsp;&emsp;基于受限玻尔兹曼机的协同过滤方法的最大问题是连接隐层和可见层的权重参数规模过大，同时由于受限玻尔兹曼机的训练过程往往依靠变分 推理和蒙特卡罗采样等近似优化方法，训练的时间过长，导致基于受限玻尔兹曼机的协同过滤方法在实际应用中受到很大限制。

<br>

###2.2 基于自编码器的协同过滤方法

&emsp;&emsp;自编码器也被应用于协同过滤中， 其通过对用户或项目的显式或隐式反馈数据进行重构，能够学习用户或项目的隐表示，并基于这种隐 表示预测用户对项目的偏好。图 9是一个基本的基于自编码器的协同过滤模型结构：

![图9:基于自编码器的协同过滤模型的基本结构](https://upload-images.jianshu.io/upload_images/10947003-b0fc38746e8ee491.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600)

#### 2.2.1 基于自编码器的协同过滤方法

#####2.2.1.1 基于自编码器的协同过滤方法

- ###### Paper：

&emsp;&emsp;2015 - [AutoRec: Autoencoders Meet Collaborative Filtering](http://delivery.acm.org/10.1145/2750000/2742726/p111-sedhain.pdf?ip=202.114.2.108&id=2742726&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522747032_8c3d3dbf0f1b474e6901efe49731e22d)

- ###### 基本思想：

&emsp;&emsp;基于自编码器的协同过滤方法(AutoRec)，该模型的输入为评分矩阵R中的一行(user-based)或者一列(item-based)，利用一个编码过程和一个解码过程产生输出，通过最小化重构误差进行模型参数优化。

#####2.2.1.2 两个栈式降噪自编码器(SDAE)

- ###### Paper：

&emsp;&emsp;2015 - [Collaborative Filtering with Stacked Denoising AutoEncoders and Sparse Inputs](https://hal.inria.fr/hal-01256422/document)

- ###### 基本思想：

&emsp;&emsp;采用两个栈式降噪自编码器(SDAE)，将用户和项目的评分向量分别作为输入，分别学习用户和项目的隐表示，然后通过隐表示对缺失评分进行预测。该方法与AutoRec略微不同，其针对评分矩阵的数据稀疏问题，在训练过程中通过将评分矩阵中的缺失值直接归零减少了网络的连接数量，但同时这种方式也导致未评分数据的信息被忽略。

#### 2.2.2 协同降噪自编码器模型

- ###### Paper：

&emsp;&emsp;2016 - [Collaborative denoising auto-encoders for top-n recommender systems](http://delivery.acm.org/10.1145/2840000/2835837/p153-wu.pdf?ip=202.114.2.108&id=2835837&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522810941_8462b20e6704ecdf185300cb4693eb1c)

- ###### 基本思想：

&emsp;&emsp;利用降噪自编码器来解决top-N问题，提出了协同降噪自编码器（Collaborative Denoising Auto-Encodings，CDAE）。CDAE与AutoRec方法的结构类似，通过将用户的评分向量作为输入，学习用户的低维向量表示来进行推荐。但是与AutoRec相比也存在一些差异；一是该方法不是评分预测，而是top-N推荐；二是该方法通过在评分向量中加入了噪声数据，提升了模型的鲁棒性；三是考虑不太用户的个性化因素，为每个用户引入了一个用户因子提升了推荐的准确性。

#### 2.2.3 基于自编码器的表示学习

- ###### Paper:

&emsp;&emsp;

- ###### 基本思想：

&emsp;&emsp;协同降噪自编码器（Collaborative Denoising Auto-Encodings，CDAE）在最小重构误差时既能采用逐点损失（point-wise loss）也能采用成对损失（pair-wise loss），但没有给出选择的依据。后来的研究中指出，推荐问题中每个用户的评分标准存在差异，例如有的用户对自己不是特别满意的项目可能给出高分，而一些标准苛刻的用户可能对满足自己要求的项目给出低分，因此，推荐系统的评分预测不仅仅需要使预测的评分数据与真实评分数据一致，而且还需要使预测的评分数据之间的相对排序与真实评分数据排序一致。针对这个问题，作者在推荐问题中融入成对排序损失（pair-wise ranking loss）来确保预测数据与真实数据的排序保持一致。模型利用自编码器分别学习用户和项目的隐表示，再通过组合逐点损失和成对排序损失构建目标函数，采用梯度下降方法进行参数优化，最后基于学习到的用户和项目隐表示，通过内积方式进行评分预测。

&emsp;&emsp;基于自编码器的协调过滤方法通常来说简单有效，尤其是利用栈式降噪自编码器，通过提高模型的深度和增加噪声，推荐的有效性和鲁棒性都得到了提升。

<br>

###2.3 基于分布式表示技术的协调过滤方法

&emsp;&emsp;传统的协调过滤（如矩阵因子分解）忽略了用户行为中的序列模式，但是很多推荐场景中，序列模式会对推荐的结果起到至关重要的作用，例如基于会话的推荐（session-based recommendation）问题中，一个会话之前的行为对后面的行为具有决定性作用。传统的序列模式建模方法（例如马尔可夫模型）往往存在计算复杂且准确性不高的问题。

####2.3.1 层次表示模型（Hierarchical Representation Model，HRM）

- ###### Paper：

&emsp;&emsp;2015 - [Learning Hierarchical Representation Model for NextBasket Recommendation](http://delivery.acm.org/10.1145/2770000/2767694/p403-wang.pdf?ip=115.156.140.29&id=2767694&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522823014_796ec3101d8da7144dbba5c8b20dd70e)

- ###### 基本思想：

&emsp;&emsp;将分布式表示技术用于解决下一次购物了推荐问题。购物篮推荐问题是给定用户的购物历史（通常是交易数据的序列），预测用户下一次购物行为要选择的物品。该研究考虑用户的历史序列行为和用户的长久偏好进行购物篮推荐。

&emsp;&emsp;HRM是一种两层结构的混合表示模型，第一层通过聚合最后一次交易中的所有项目的隐向量形成交易表示（建模序列模式），第二层通过聚合用户的隐向量（建模用户偏好）和交易表示构建混合表示，最终利用混合表示进行下一次购物篮预测。

<br>

####2.3.2 基于分布式表示技术的广告推荐

- ###### Paper:

&emsp;&emsp;2015 - [E-commerce in Your Inbox: Product Recommendations at Scale](http://delivery.acm.org/10.1145/2790000/2788627/p1809-grbovic.pdf?ip=115.156.140.29&id=2788627&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522824069_f273a11eecbbae6734ca04fb6342f50b)

- ###### 基本思想：

&emsp;&emsp;利用分布式表示技术研究邮件系统的广告推荐问题，利用通过用户与不同电子商务网站之间的邮件往来获取到的用户历史购买行为数据，预测用户对产品的兴趣。首先，作者提出了两种分布式表示方法获取用户或项目的分布式表示，一种是Prod2Vec方法，所有产品被独立考虑，其在产品层次上建模，采用分布式表示技术将所有产品嵌入到一个连续的、低维的向量空间：另一种方法是Bagged-Prod2Vec，其考虑一封邮件中可能包含多个产品的购买行为，在邮件层次上进行建模，采用分布式表示技术获取到更加有效的产品向量表示。获取项目的分布式表示之后，作者提出了两种推荐模型，一种是产品到产品的推荐模型，其在嵌入式空间中计算产品之间的相似度，然后利用基于用户的协调过滤产生广告推荐；另一种是用户到产品的推荐模型，其通过将用户和产品嵌入到统一的低维空间，从而通过计算用户与产品的相似度产生推荐。

<br>

&emsp;&emsp;基于分布式表示技术的协同过滤方法，能够被建模用户行为的序列影响。但是，仅仅是建模了用户行为的局部情境信息，并不能完全有效地抓住用户行为的序列模式，但同时，由于其简单而且训练高效，目前在推荐系统研究中引起了大量的关注。

<br>

### 2.4 基于循环神经网络的协调过滤方法

&emsp;&emsp;循环神经网络模型的提出正是被用于建模序列数据，因此很快被引入到用户行为序列模式建模的研究中。基于循环神经网络的协调过滤与基于分布式表示技术的协同过滤相似，都能用来建模用户行为的序列模式，但区别在于分布式表示技术仅仅抓住了用户行为的局部情境信息，而RNN能够建模用户行为追安的相互依赖关系，基于循环神经网络的协调过滤的主要思路是通过循环神经网络建模用户历史序列行为对下一时刻用户行为的影响，从而实现用户的项目推荐和行为推荐。图10是一个基本的基于RNN的协同过滤方法的框架。

![图10:基于RNN的协调过滤方法的框架](https://upload-images.jianshu.io/upload_images/10947003-578c11cf2227a90e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600)

#### 2.4.1 基于会话的推荐

##### 2.4.1.1 基于会话的推荐

- ###### Paper：

&emsp;&emsp;2016 - [Session-based Recommendations with Recurrent Neural Networks](https://arxiv.org/pdf/1511.06939.pdf)

- ###### 基本思想：

&emsp;&emsp;基于会话的推荐系统主要利用当前会话中的历史行为来预测下一步点击每个项目的概率，最大的特点是指考虑了一个会话期间的行为数据。采用GRU抓住会话中行为之间的依赖关系，在每一个时间点上，模型的输入是当前点击的项目的one-hot编码，然后通过一个嵌入层压缩为低维连续向量，中间是多个基本GRU层，最后是一个前向层，输出层利用Softmax等方法计算的每个项目的点击率。为了实现并行计算，该研究采用了mini-batch处理，即把不同的会话拼接起来。此外，在输出阶段，考虑到项目数量太多会导致计算量过大，通过对所有项目进行抽样，仅仅预测部分项目被点击的概率。

&emsp;&emsp;基本的架构如图11所示：

![图11:基于会话的推荐系统的基本架构](https://upload-images.jianshu.io/upload_images/10947003-194d6d84be07b176.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



##### 2.4.1.2 改进的基于会话的推荐

- ###### Paper：

&emsp;&emsp;2016 - [Improved Recurrent Neural Networks for Session-based Recommendations](http://delivery.acm.org/10.1145/2990000/2988452/p17-tan.pdf?ip=115.156.140.29&id=2988452&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1522827110_1733a7c3aad644b3c87a538fca81217c)

- ###### 基本思想：

&emsp;&emsp;对基于会话的推荐做了一系列的改进，一是数据增强（data augumentation），首先是通过将每一个长度的序列都作为一个训练样本来增加训练样本的数量，然后采用嵌入式Dropout随机去除一些序列中的节点，帮助缓解由于噪声数据导致的过拟合。二是预训练，考虑到用户偏好会随时间变化，通过利用所有历史数据对模型进行预训练，然后仅仅利用最近的数据进行更精细粒度的训练，这样同时抓住了用户的长时偏好和短时偏好。三是利用特权信息进行训练，在模型训练过程中，通过融入用户行为序列中预测时间点之后的数据，提升了模型的预测精度。

#### 2.4.2 融入时间序列信息的协同过滤

&emsp;&emsp;传统的协调过滤方法并没有考虑用户行为的时间信息，但是时间信息反映了用户行为的时间序列模式，有效地利用时间信息有利于提升推荐系统的性能。

##### 2.4.2.1 多等级时间深度语义结构化模型（Mutil-Rate TDSSM）

- ###### Paper：

&emsp;&emsp;2015 - [Learning Image and User Features for Recommendation in Social Networks](https://www.cv-foundation.org/openaccess/content_iccv_2015/papers/Geng_Learning_Image_and_ICCV_2015_paper.pdf)

- ###### 基本思想：

&emsp;&emsp;通过融入时间信息并在多种粒度上建模用户的兴趣偏好，提出一种多等级时间深度语义结构化模型（Mutil-Rate TDSSM）。

##### 2.4.2.2 循环神经网络模型& Log 双线性模型(Log-BiLinear, LBL)

- ###### Paper：

&emsp;&emsp;2017 - [Multi-Behavioral Sequential Prediction with Recurrent Log-Bilinear Model](http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7837622)

- ###### 基本思想：

&emsp;&emsp;考虑到推荐系 统中的用户行为往往存在多种类型，采用循环神经 网络模型和 Log 双线性模型(Log-BiLinear, LBL) [84]分别建模用户行为之间的长程依赖关系和短时 情境信息，从而提出了一种循环 Log 双线性模型 (Recurrent Log-BiLinear, RLBL)，实现用户在下 一时刻的行为类型预测。

##### 2.4.2.3 循环神经网络用于建模用户的时间序列行为

- ###### Paper：

&emsp;&emsp;2016 - [Recurrent neural network based recommendation for time heterogeneous feedback](https://www.sciencedirect.com/science/article/pii/S095070511630199X)

- ###### 基本思想：

&emsp;&emsp;将循环神经网络用于建模用户的时间序列行为，该研究区分了不同类型的显式反馈和隐式反馈数据，提出的模型分为两个部分，一个是循环部分，是一个RNN 结构， 通过区分不同的行为类型抓住所有历史反馈对当前用户行为的影响，另一个是非循环部分，是一个全连接神经网络结构，主要建模了用户基本的偏好，最后通过组合两个部分对用户进行推荐。

##### 2.4.2.4 循环公演化特征嵌入过程模型（Recurrent Coevolutionary Feature Embedding Process）

- ###### Paper：

&emsp;&emsp;2016 -  [Deep Coevolutionary Network: Embedding User and Item Features for Recommendation](https://arxiv.org/pdf/1609.03675.pdf)

- ###### 基本思想：

&emsp;&emsp;考虑到用户偏好和项目特征会根据用户交互随时间演化的特点，基于循环神经网络和多维时间点过程模型，提出了一种循环共演化特征嵌入过程模型（Recurrent Coevolutionary Feature Embedding Process）。实现用户偏好和项目特征的演化跟踪，并学习到用户和项目在每一时刻的隐表示，最后通过对用户和项目的隐表示进行内积来产生项目推荐。

##### 2.4.2.4 循环推荐网络（Recurrent Recommender Network，RNN）

- ###### Paper：

&emsp;&emsp;

- ###### 基本思想：

&emsp;&emsp;采用循环神经网络建模用户偏好和项目特征的演化，提出一种循环推荐网络（Recurrent Recommender Network，RNN），能够预测用户未来的行为轨迹。具体的，RNN首先利用低维矩阵因子分解学习用户和项目的静态隐表示，同时将用户的历史评分书数据作为输入采用LSTM学习用户和项目在每一时刻的动态隐表示，单一时间的评分预测是利用两类隐表示分别做内积然后进行聚合。

<br>

&emsp;&emsp;基于循环神经网络的协同过滤方法，由于其能够有效建模用户行为中的序列模式。同时通过改变循环神经网络的输入[85]和定义不同的权值矩阵[29]，还能够融入时间等情境信息[10]，以及各种类型的辅以及各种类型的辅 助数据来提升推荐的质量[28]，模型具有高的适用滤方法并没有考虑用户行为的时间信息，但是时间性，在当前的推荐系统中得到了广泛应用。

&emsp;&emsp;参考文献见论文。

<br>

###2.5 基于生成对抗网络的协调过滤方法

#### 2.5.1 IRGAN

- ###### Paper：

&emsp;&emsp;2017 - [IRGAN: A Minimax Game for Unifying Generative and Discriminative Information Retrieval Models](http://delivery.acm.org/10.1145/3090000/3080786/p515-wang.pdf?ip=202.114.2.108&id=3080786&acc=ACTIVE%20SERVICE&key=BF85BBA5741FDC6E%2ECC932049E1B2BA72%2E4D4702B0C3E38B35%2E4D4702B0C3E38B35&__acm__=1523190592_2f42f7e438d6da529778d7742ba6f2dd)

- ###### 基本思想：

&emsp;&emsp;IRGAN首次将GAN引入 到信息检索领域，文章提供了信息检索建模中两种 思维流派的统一描述:生成检索模型和判别检索模 型。

<br>

&emsp;&emsp;生成对抗网络由于引入了对抗机制，在推荐系统中能够取得不错的效果，但目前在推荐系统中的 应用还处于探索阶段，还有待更输入的研究

<br>.

###2.6 基于其他深度学习模型的协调过滤方法

&emsp;&emsp;除了RBM、AE、分布式表示技术、RNN和对抗神经网络之外，目前被用于协同过滤的深度学习模型还包括卷积神经网络、神经自回归分布估计模型(Neural Autoregressive Distribution Estimator, NADE)

#### 2.6.1 社交内容网络中用户和 图像的统一表示

- ###### Paper：

&emsp;&emsp;[24]

- ###### 基本思想：

&emsp;&emsp;Geng 等人针对社交内容网络中用户与图像 之间的连接稀疏以及图像内容多样的问题，提出了一种神经网络模型来学习社交内容网络中用户和图像的统一表示。该模型利用用户和图像之间由历史交互形成的二部图网络结构，采用卷积神经网络模型通过最大化模块度[105]的方法学习用户与图像 的深层次统一表示，从而在同一空间中通过计算用 户和图像的相似度为用户进行图像推荐。

#### 2.6.2 NADE

- ###### Paper：

&emsp;&emsp;[107]

- ###### 基本思想：虑到基于 RBM 的协同过滤方法存在优化困难的问题，使用NADE 替代 RBM 来进行协同过滤推荐，NADE不需要融入任何隐变量，因此避免了复杂的隐变量推理过程，从而减少了模型复杂度。

&emsp;&emsp;

<br>

&emsp;&emsp;总的来说，基于深度学习的协同过滤能够当作传统隐因子模型的一种非线性泛化[20]。其最大的优 点是在学习用户和项目隐表示的过程中引入了非 线性的特征变换，相比传统的协同过滤方法(如矩 阵因子分解)具有更好的性能[25,30]。但同时这类方 法仍然无法改变传统协同过滤方法存在的数据稀 疏问题，以及新用户和新项目的冷启动问题。

<br>

## 3 深度学习在混合推荐系统中的应用

&emsp;&emsp;传统的协同过滤方法仅仅利用用户的显式反馈或隐式反馈数据，面临数据稀疏问题。因此，通过融入用户画像数据、项目内容数据、社会化标注、 评论等辅助数据的混合推荐方法，能够有效缓解数据稀疏问题，但是这种方法面临最大的难题是辅助数据的表示问题，经典的方法，如协同主题回归(CollaborativeTopicRegression,CTR))[108]，并不能够获取有效的辅助数据表示[4]。深度学习通过自动特征提取，能够被用于从辅助数据中学习到有效的用户和项目的隐表示。基于深度学习的混合推荐方法利用用户对项目的显式反馈或隐式反馈数据，以及用户画像数据、项目内容数据、社会化标注、评论等辅助数据，构建一个基于深度学习的推荐模型进行项目推荐。

&emsp;&emsp;基于深度学习的推荐方法的主要思路是融合基于内容的推荐方法与协同过滤，将用户或项目的特征学习与项目推荐过程集成到一个统一的框架 中，首先利用各类深度学习模型学习用户或项目的隐特征，并结合传统的协同过滤方法构建统一的优化函数进行参数训练，然后利用训练出来的模型获取用户和项目最终的隐向量，进而实现用户的项目推荐。根据深度学习模型的不同，本文将基于深度学习的推荐方法分为以下两类。

### 3.1 基于自编码器的混合推荐方法

#### 3.1.1 协同深度学习模型

##### 3.1.1.1 贝叶斯栈式降噪自编码器模型(Bayesian SDAE)

- ###### Paper：

&emsp;&emsp;2015-KDD - [4]

- ###### 基本思想：

&emsp;&emsp;一种贝叶斯版本的降噪自编码器模型，即贝叶斯栈式降噪自编码器模型(Bayesian SDAE)，然后组合 Bayesian SDAE 和概率矩阵分解，提出了一种协同深度学习(Collaborative Deep Learning, CDL)混合推荐方法。该方法利用Bayesian SDAE 学习项目的隐表示，主要利用项目的文本类辅助数据。

##### 3.1.1.2 关系栈式降噪自编码器模 型 ( Relational Stacked Denoising Autoencoder, RSDAE)

- ###### Paper：

&emsp;&emsp;[32]

- ###### 基本思想：

&emsp;&emsp;将CDL扩展应用到标签推荐问题中，提出一种关系栈式降噪自编码器模 型 ( Relational Stacked Denoising Autoencoder, RSDAE)。采用SDAE从项目的内容信息中学习项目的隐表示，利用概率矩阵分解建模标签与项目之间的共现信息，同时融入了标签系统中可能存在的各类关系数据。CDL模型中，项目的文本辅助信息是由词袋模型表示，这种方式忽略了文本内容中词语序列所包含的信息。

##### 3.1.1.3 协同循环自编码器模型(Denoising Recurrent Autoencoder, CRAE)

- ###### Paper：

&emsp;&emsp;[31]

- ###### 基本思想：

&emsp;&emsp;针对以上问题，提出了一种协同循环自编码器模型(Denoising Recurrent Autoencoder, CRAE)，用来代替SDAE进行项目推荐。CRAE拥有一种自编码器结构，在编码器和解码器中，分别利用一个循环神经网络建模文本序列的生成，从而抓住文本中词语的序列信息。

##### 3.1.1.4 协同变分自编码器方法 ( Collaborative Variational Autoencoder, CVAE ) 

- ###### Paper：

&emsp;&emsp;[106]

- ###### 基本思想：

&emsp;&emsp;另外一个CDL的扩展是协同变分自编码器方法 ( Collaborative Variational Autoencoder, CVAE ) ，CVAE使用变分自编码器代替SDAE从项目的内容中学习项目的隐表示。相比CDL，推理的过程更加简单，且不需要在输入中加入噪声，能够从图像、文本等项目内容中提取特征。

##### 3.1.1.5 协同深度排序模型(Collaborative Deep Ranking, CDR)

- ###### Paper：

&emsp;&emsp; [40]

- ###### 基本思想：

&emsp;&emsp;将CDL模型进行扩展，提出一种协同深度排序模型(Collaborative Deep Ranking, CDR)，CDR与CDL的区别在于，CDR利用了成对损失函数代替CDL使用的逐点损失函数进行模型优化。

#### 3.1.2 协调知识库嵌入模型( Collaborative Knowledge Base Embedding , CKE)

- ###### Paper：

&emsp;&emsp; [5]

- ###### 基本思想：

&emsp;&emsp;利用与 CDL相似的模型架构，融入项目之间的结构化信息 (项目之间的各类关系)和非结构化信息(文本数 据和图像数据)到推荐系统中，通过组合深度学习方法和概率矩阵分解模型，提出了一种协同知识库嵌入模型 ( Collaborative Knowledge Base Embedding , CKE)。CKE 利用了三种非监督表示 学习方法从项目相关的结构化和非结构化信息学习项目的隐表示，具体来说，利用项目相关的结构化信息通过采用一种知识库嵌入式方法 TransR[108] 将项目嵌入到隐空间学习项目的结构化向量，利用项目相关的文本信息通过采用 SDAE 提取文本的分布式表示来得到项目的文本向量，利用项目相关的 图像信息通过提出一种栈式卷积自编码器(Stacked Convolutional Autoencoders, SCAE)模型提取视觉 图像的分布式表示来得到项目的视觉向量，并通过 融合项目的三类向量得到项目的隐表示，最后结合 PMF 学习到用户和项目最终的隐表示。与 CDL 相 比，CKE 集成了更多的辅助信息来学习项目的隐表示，另外，CKE 中的协同过滤利用了成对排序损失。

<br>

#### 3.1.3 基于SDAE的方法

- ###### Paper：

&emsp;&emsp; [42]

- ###### 基本思想：

&emsp;&emsp;通过组合协同过滤方法 TimeSVD++[111] 和栈式降噪自编码器 SDAE，提出了一种混合推荐方法。该研究利用 SDAE 从项目的辅助信息中学习项目的隐表示，利 用 TimeSVD++拟合用户和项目之间的评分矩阵。 与CDL相比，该模型利用的TimeSVD++是一类融合了时间因素的隐因子模型，因此建模了用户偏好和项目特征随时间的变化，有利于提升推荐系统的性能。

#### 3.1.4 基于mDA的方法

- ###### Paper：

&emsp;&emsp; [17]

- ###### 基本思想：

&emsp;&emsp;通过将边缘降噪自编码器 ( Marginalized Denoising Auto-encoder,mDA)[110]和概率矩阵分解方法进行组合，提出一种混合推荐方法。mDA 是降噪自编码器的一类扩 展，通过对降噪自编码器的输入噪声进行边缘化避 免了训练降噪自编码器所需要的大的计算开销，提 升了模型的可扩展性。与 CDL 和 CRAE 的不同之 处在于，该模型不仅考虑了项目相关的辅助信息来 学习项目的隐表示，还融入了用户相关的辅助数据 来学习用户的隐表示，此外该模型并没有像 CDL 和 CRAE 一样采用贝叶斯形式，而是利用边缘降噪自编码器，具有更少的模型参数，具有更高的可扩展性。

 #### 3.1.5 基于aSDAE的方法

- ###### Paper：

&emsp;&emsp; [59]

- ###### 基本思想：

&emsp;&emsp;提出了一 种基于附加栈式降噪自编码器(Additional Stacked Denoising Autoencoder, aSDAE)的混合推荐方法， aSDAE是SDAE的扩展，其输入是用户或者项目的 评分向量，只是在 SDAE 的每个隐层都加入用户或者项目的辅助信息，在输出端同时重构输入数据和 辅助数据。该研究利用 aSDAE 学习用户和项目的隐表示，然后结合矩阵因子分解(MF)和 aSDAE 构建联合目标优化函数，采用梯度下降方法进行参 数优化，进而对未知评分进行预测。相比 CDL 方法，该模型能够融入更加精细的辅助数据，且具有更少的模型参数。

<br>

### 3.2 基于其他深度学习模型的混合推荐方法

&emsp;&emsp;除了自编码器之外，目前被用于混合推荐的深度学习模型还包括多层感知机、卷积神经网络和循 环神经网络等。虽然基于深度学习的中混合推荐方 法都采用深度学习加协同过滤的模型框架，但是自编码器是采用非监督学习过程从辅助信息中学习到用户和项目的隐表示，因此在模型最终的优化过程中除了拟合用户与项目的显式反馈或隐式反馈数据之外，还融入了自编码器的重构误差，而其他监督深度学习方法将从辅助信息中学习用户和项目隐表示的过程和拟合协同信息的过程集成到一个统一的监督学习框架中，从而在最终的模型优化 过程中只拟合用户与项目的显式反馈或隐式反馈数据。因此，两种方法的最大区别在于最终优化目标函数的构建。图 22 给出了一个基本的模型架构， 深度学习模型用来从用户特征 X 和项目特征 Y 中学习用户隐表示U 或项目隐表示V(此处并没有自编码器的输入数据重构过程)，然后将隐表示融入到隐因子模型中拟合用户-项目交互矩阵 R(如评分矩阵)，通过拟合交互矩阵的误差 (R,U ,V ) 构建统一的目标优化函数，利用最终学习到的用户和项目隐表示对用户产生推荐。

### 3.2.1 基于 MLP 的混合推荐方法。

#### 3.2.1.1 协同测度学习 (Collaborative Metric Learning, CML)方法

- ###### Paper：

&emsp;&emsp; [15]

- ###### 基本思想：

&emsp;&emsp;传统矩阵分解方法通常采用内积的方式来衡量用户向量和项目向量的距离。利用测度学习来学习数据之间的相似度，并将测度学习(Metric Learning, ML)和协同过滤结合，提出了一种协同测度学习 (Collaborative Metric Learning, CML)方法。该研究指出内积操作由于不具有距离相似度的传递性，不死一个合理的距离测度，会带来相似度学习不准确的问题。因此，CML 通过大边界最近邻方法 (Large Margin Nearest Neighbor，LMNN)进行测 度学习来学习数据之间的相似度。最后，在测度学习损失函数的基础上，通过 MLP 融入项目相关的 特征数据，通过加权近似排序成对损失[112]融入用户的隐式反馈数据，并加入正则化因子，构建统一的目标优化函数，最后学习到用户和项目隐向量，进而实现 Top-K 推荐。

#### 3.2.1.2 注意力协同过滤模型(Attentive Collaborative Filtering, AFC)

- ###### Paper：

&emsp;&emsp; [113]

- ###### 基本思想：

&emsp;&emsp;在多媒体推荐中，通过引入一个 两种层次的注意力机制到隐因子模型中，提出了一 个注意力协同过滤模型(Attentive Collaborative Filtering, AFC)。AFC 是一个多层感知机，包括两种层次的注意力机制，一个项目层次的注意力机制被用来刻画不同项目匹配用户兴趣的程度，一个部件层次的注意力机制被用来抓住多媒体辅助信息中对用户最具有代表性的特征。

#### 3.2.2 基于CNN的混合推荐方法

- ###### Paper：

&emsp;&emsp; [71]

- ###### 基本思想：

&emsp;&emsp;利用卷积神经网络将项目相关的文本辅助数据融入到推荐系统中，提出了一种卷积矩阵因子分解模型 (Convolutional Matrix Factorization, ConvMF)。 虑到 CDL 等方法采用词袋模型对文本进行表示， 无法有效利用文本内部的情境信息，ConvMF 利用 CNN 的多层卷积操作抓住文本中词语之间的相互关联，并学习到用户和项目的隐表示，提升了推荐系统评分预测的准确性。ConvMF 首先对文档中每个词做嵌入式表示，然后将所有词拼接组成一个 嵌入式矩阵，一篇文档即可用一个二维矩阵表示， 然后在该矩阵上进行卷积、池化以及映射，从而获 取到项目的隐向量。假设用户的隐向量满足高斯分布。模型的目标函数由矩阵因子分解和 CNN 的损失函数共同组成。

### 3.2.3 基于RNN的混合推荐方法

#### 3.2.3.1 一种基于循环神经网络模型的文本推荐方法

- ###### Paper：

&emsp;&emsp; [19]

- ###### 基本思想：

&emsp;&emsp;与 ConvMF 相同， 为了抓住文本辅助数据中词语之间的序列关系， Bansal 等人基于循环神经网络模型提出了一种文本推荐方法，在利用评分数据的同时，还利用了文本内容信息和文本标签数据进行推荐。具体来说， 为了更好地抓住文本中词语的序列模式，该模型利用 GRU 学习文本内容的向量表示，然后基于隐因子模型采用一个多任务学习框架(包括文本推荐和 标签预测两个任务)构建一个联合优化目标函数， 在监督学习的框架下实现对模型参数的优化。与 CDL 和 CRAE 相比，虽然也是利用项目相关的文本 数据学习项目的隐向量表示，但是该方法是一个完全端到端的监督学习架构。

#### 3.2.3.2 一种基于RNN的App的评分预测与抽象tips生成方法

- ###### Paper：

&emsp;&emsp; [114]

- ###### 基本思想：

&emsp;&emsp; 利用深度学习模型来研究App的评分预测与抽象tips生成问题，提出了一个多任务学习框架，同时进行评分预测与抽象tips生成，具体地，在评分预测任务中，作者利用用户和项目的隐向量作为输入，利用一个多层感知机(MLP)来进行评分预测。在抽象tips生成中，作者利用用户和项目的隐向量作为输入，利用一个GRU来进行文本生成。最后在一个多任务框架中进行模型训练。

<br>

&emsp;&emsp; 基于深度学习的混合推荐中，深度学习方法主 要被用于从辅助数据中提取有效的隐表示。当前的 大部分研究都采用深度学习加隐因子模型的推荐框架，研究的区别主要体现在辅助数据的类型、深度学习的方法和隐因子方法三个方面的选择不同，论文P20页总结了相关的代表性研究。

<br>

&emsp;&emsp;总的来说，基于深度学习的混合推荐通过融入 辅助信息能够有效缓解协同过滤推荐中存在的数 据稀疏和冷启动问题。但是，目前的大部分研究都 是针对不同的数据采用不同的表示学习模型，构建 一个针对所有数据的、统一的混合推荐框架是下一步的重要方向。

<br>

## 4 深度学习在基于社交网络的推荐系统中的应用

&emsp;&emsp;当前，社交网络作为一种开放的公众参与的信息交流与业务服务平台，迅速进入了人们的日常工作和生活中。同时，随着移动互联网的发展，位置社交网络也已经得到了广泛的普及。基于社交网络中的推荐系统旨在解决社交媒体平台中“信息过载” 的问题，已经成为社交媒体挖掘领域的热门话题。 目前，深度学习与基于社交网络的推荐系统的结合也引发了一系列的研究成果，主要体现在两个方 面:

&emsp;&emsp;(1)基于深度学习的社交网络社会化关系影响建模;

&emsp;&emsp;(2)基于深度学习的位置社交网络序列模式建模。

### 4.1 基于深度学习的社交网络社会化关系影响建模

&emsp;&emsp;社交网络的用户之间存在各种类型的社会化关系(例如朋友关系、关注关系)，用户之间通过社会化关系会产生相互影响，并具有相似的兴趣偏好。基于社交网络的推荐系统最重要的是需要考虑用户之间的相互影响来提升推荐系统的质量。通常，社会化关系通过图结构进行表示，基于社会网络的推荐系统通常采用图模型或正则化技术来建模用户之间的社会化关系影响[115]，但是这种方法容易受到图结构的稀疏性以及高的计算复杂性的影响。当前，针对这些问题，研究者通过利用深度学习开展了一些针对性工作。

#### 4.1.1 基于MLP的推荐方法

- ###### Paper：

&emsp;&emsp;[116]

- ###### 基本思想：

&emsp;&emsp;基于神经协同过滤方法，研究了跨信息网络和社交网络的社会化推荐问题。通过分别在两个领域进行嵌入式学 习，同时让桥接用户共享相同的嵌入空间，来学习用户和项目一致的隐表示。在信息网络领域，作者 基于MLP，提出了一种属性感知的深度协同过滤模 型(Attributed-aware Deep CF Model)，模型架构如图12所示，模型将用户和项目的ID号和属性信息 作为输入，通过多层神经网络预测用户对项目的偏好。在社交网络领域，基于信息网络中桥接用户的隐表示，通过假设朋友之间具有相近的兴趣来学习其他用户的隐表示，最后通过组合两个领域的损失函数构建统一的优化函数进行模型训练。

![图12:属性感知的深度协同过滤模型架构](https://upload-images.jianshu.io/upload_images/10947003-f9c4986d1c040e2a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600)

#### 4.1.2 基于分布式表示技术的推荐方法

##### 4.1.2.1 基于深度学习的网络表示技术建模社会化影响

- ###### Paper：

&emsp;&emsp;[34]

- ###### 基本思想：

&emsp;&emsp;为了融入社会化影响到推荐系统中，采用基于深度学习的网络表示技术建模社会化影响。基于用户的 社交网络结构，通过网络表示技术将用户节点嵌入 到一个共享的隐空间，每个用户用一个低维、稠密的向量进行表示，从而用网络表示技术建模社交网络的生成，能够缓解社交网络图结构的稀疏性问题，同时基于深度学习的网络表示技术具有高的可 扩展性，能够适应于大规模数据集。

##### 4.1.2.2 结合使用深度学习与矩阵因子分解

- ###### Paper：

&emsp;&emsp;[38]

- ###### 基本思想：

&emsp;&emsp;通过组合深度学习与矩阵因子分解，研究如何利用社交网络数据为社交网络中的冷启动用户(即在电 子商务网站中没有购买记录)推荐电子商务网站中的产品。首先，通过利用神经网络模型(即 Word2Vec 和 Para2Vec)从用户购买行为数据中学习用户和项目的嵌入式表示，同时为了融入社交网络信息，利用改进的梯度 Boost 树方法从社交媒体用户数据中学习用户的嵌入表示，最后，利用基于特征的矩阵因子分解联合两个方面学习到的隐表示进行训练和预测，从而通过引入社交网络数据解决跨平台冷启动问题。

#### 4.1.3 基于自编码器的推荐方法

##### 4.1.3.1 通过正则化技术融入用户信任关系影响到推荐系统

- ###### Paper：

&emsp;&emsp;[41]

- ###### 基本思想：

&emsp;&emsp;针对传统矩阵因子分解中用户和项目的隐特征初始化困难的问题以及用户信任关系多样化的问题，采用 深度自编码器模型初始化用户和项目的隐特征向量，通过正则化技术融入用户信任关系影响到推荐 系统中，有效提升了推荐系统的性能。

##### 4.1.3.2 融入信任关系到评分预测问题

- ###### Paper：

&emsp;&emsp;[117]

- ###### 基本思想：

&emsp;&emsp;研究了如何融入信任关系到评分预测问题中，作者采用降噪自编码器通过重构用户的评分向量和信任关系向量学习评分隐向量和信任隐向量，通过一个加权隐层来平衡这种隐向量，并利用一个关联正则项来构建两者之间的桥梁来学习的用户的偏好， 最终基于学习到的隐向量来进行 top-N 推荐。

#### 4.1.4 基于RBM的推荐方法

- ###### Paper：

&emsp;&emsp;[118]

- ###### 基本思想：

&emsp;&emsp;在Salakhutdinov 等人[21]的工作的基础上，通过两种方式建模社会化关系对推荐结果的影响，一种是将社会化关系和用户评分一样，都作为 RBM 的观测变量，通过同时拟合社会化关系和用户评分实现社会化影响建模;另一种是在RBM中增加一个隐含层，在这个隐含层层上通过朋友间的权值共享实现社会化影响建模。

&emsp;&emsp;通过深度学习方法将社交网络中的社会化关系影响融入到推荐系统中，有利于缓解推荐系统的数据稀疏和冷启动问题，从而提升推荐系统的质量。同时，深度学习模型能够适应于大规模数据，具有高的可扩展性。但总的来说，深度学习在基于社交网络的推荐系统中的应用还非常少，诸如如何区分关系强度、如何有效建模社会化影响、结构洞等理论到推荐系统中，都还有待深入的研究。

### 4.2 基于深度学习的位置社交网络序列模式建模

&emsp;&emsp;位置社交网络中，所有项目(也就是兴趣点，Point-of-interest, POI)都具有位置属性，用户行为具有时间和空间上的序列模式，对这种时空序列模式的建模有利于提升 POI 推荐的准确率。因此，位置社交网络的推荐系统除了需要关注用户之间的社会化关系，还需要抓住用户的位置影响、序列移动模式等因素。

### 4.2.1 基于MLP的推荐方法

- ###### Paper：

&emsp;&emsp;[119]

- ###### 基本思想：

&emsp;&emsp;针对当前 的POI推荐方法都是针对特定的数据和问题而设计的问题，基于MLP提出了一个通用的半监督学习框 架，即偏好与情境嵌入模型(Preference And Context Embedding, PACE)，能够利用相邻用户和位置的信 息来缓解推荐系统的数据稀疏问题。PACE首先构 建情境图作为观测数据，即利用位置间的距离构建 位置图，利用用户之间的朋友关系构建用户图。 PACE的模型架构如图24所示，其输入是用户和项 目的one-hot向量，输出是用户和项目的情境信息以及用户对POI的访问次数，分别建模了用户与用户 之间的情境、项目与项目之间的情境，以及用户对 POI的偏好。最后，PACE联合三个方面的损失函数 建立优化函数，通过学习到的模型进行POI推荐。

#### 4.2.2 基于CNN的推荐方法

- ###### Paper：

&emsp;&emsp;[120]

- ###### 基本思想：

&emsp;&emsp;研究了融入图像内容信息来提升POI推荐的问题，作者基于CNN和概率矩阵因子分解，提出了一种视觉内容增强的POI推荐模型（Visual Content Enhanced POI Recommendation，VPOI）。VPOI利用CNN来从图像内容中提取特征，通过用户-图像关系、POI图像关系和用户-POI关系三类关系，构建了一个概率主题模型，最后将图像的特征提取和概率主题模型融合到一个统一框架中构建优化函数，采用 Negative Sampling方法进行参数优化。融合到一个统一框架中构建优化函数，采用 Negative Sampling方法进行参数优化。

#### 4.2.3 基于 RNN 的推荐方法

#####4.2.3.1 位置社交网络中的行为预测问题

- ###### Paper：

&emsp;&emsp;[28]

- ###### 基本思想：

&emsp;&emsp;研究了位置社交网络中的行为预测问题，通过利用循环神经网络抓住序列行为之间的依赖关系，从而基于用户的历史行为序列帮助预测下一时刻的行为。

#####4.2.3.2 利用循环神经网络进行位置推荐

- ###### Paper：

&emsp;&emsp;[34]

- ###### 基本思想：

&emsp;&emsp;利用循环神经网络建模位置社交网络中的用户序列移动模式，同时融合用户的社会化关系影响进 行位置推荐。具体地，模型由两个部分组成:社会 网络的构建和移动轨迹的生成。首先采用网络嵌入 方法构建社会网络，再利用用户的访问偏好、用户 朋友的影响、用户的短时序列情境和长时序列情境 共同建模序列的生成。为了刻画两种情境信息，在 短时和长时两个情境下分别采用 RNN 和 GRU 抓住 用户移动模式中的序列关联性。最后组合社会网络 的构建和移动轨迹的生成建立目标函数，采用随机 梯度下降法进行模型训练。

#### 4.2.4 基于分布式表示的推荐方法

#####4.2.4.1 采用 Word2Vec 技术开展位置社交网络推荐

- ###### Paper：

&emsp;&emsp;[121]

- ###### 基本思想：

&emsp;&emsp;利用用户与项目之间的共现信息，采用 Word2Vec 技术开展位置社交网络推荐问题研究。首先，通过 Word2Vec 技术利用用户的历史签到行为将用户和项目嵌入到一个共享的低维空间，然后，借鉴基于内容的推荐方法和基于用户的协同过滤方法，采最近邻算法找到用户最感兴趣的项目，并产生用户的项目推荐。

#####4.2.4.2 序列嵌入排序模型(SEquential Embedding Rank, SEER) 模型

- ###### Paper：

&emsp;&emsp;[33]

- ###### 基本思想：

&emsp;&emsp;考虑建模用户的兴趣偏好和移动模式来进行兴趣点推荐，利用分布式表示技术抓住用户行为中序列模式，并提出了一种序列嵌入排序模型(SEquential Embedding Rank, SEER) 模型。具体来说，SEER 通过将序列嵌入作为约束 加入到成对排序模型中来融入序列模式影响，同时抓住时间和空间信息进行兴趣点推荐。

<br>

&emsp;&emsp;通过深度学习方法将用户行为序列影响融入到推荐系统中，有利于抓住用户行为之间的依赖关 系，从而提升推荐系统的质量。但深度学习在位置 社交网络推荐系统中的研究还面临诸多难题，例如，如何通过深度学习融合各类异构的数据源，以 及如何集成社会化关系影响、位置影响、时间影响和序列模式等要素构建统一的推荐框架等。

<br>

## 5 深度学习在情境感知的推荐系统中的应用

&emsp;&emsp;情境感知的推荐系统主要通过集成用户的情境信息到推荐过程中，从而改善推荐结果。在情境感知的推荐系统中，因为考虑了情境信息，传统的推荐函数从 s :U x I - R 变为 s :U x I x C - R ，其中 C 表示所有情境的集合。当前，深度学习在情境感知的推荐系统中的应用主要集中在如何采用深度学习方法对情境信息进行有效建模，主要表现在两个方面:

&emsp;&emsp;(1)如何采用深度学习方法融入情境信息到推荐系统中，即基于深度学习的情境感知的推荐;

&emsp;&emsp;(2)如何采用深度学习方法实现对情境信息的有效表示，即基于深度学习的情境信息表示。

### 5.1 基于深度学习的情境感知的推荐

- ###### Paper：

&emsp;&emsp;[28]

&emsp;&emsp;[122]

- ###### 基本思想：
&emsp;&emsp;情境感知的推荐系统通过将问题表示为一个三维矩阵上的矩阵补全问题，能够简单地融入情境信息到推荐系统中。但是对于很多复杂场景下的推荐问题(例如序列推荐问题)，融入情境信息到推荐系统中是很困难的。

&emsp;&emsp;Liu 等人考虑到传统的序列推荐中除了需要考虑用户的序列影响在外，还需要考虑用户行为的情境信息，通过改进传统的循环神神经网络结构融入情境信息到序列推荐中。在第一篇论文中，作者提出了一种空时循环神经网络模型(Spatial Temporal Recurrent Neural Network, ST-RNN)，针对不同粒度的时间间隔和距离长度，通过在循环神经网络模型中定义不同的时间转换矩阵和位置转换矩阵，有效地抓住了连续的时间和空间情境信息对用户的影响行为，提升了位置推荐的质量。

&emsp;&emsp;在第二篇论文中，作者将情境信息分为输入情境（如位置、天气等）和转换情境（时间间隔长度），具体通过在循环神经网络中采用可适应的、情境具体的输入矩阵和转换矩阵对两种情境信息进行建模，帮助提升了序列推荐的质量。

### 5.2 基于深度学习的情境信息表示

&emsp;&emsp;传统的情境感知的推荐系统通常采用图模型、主题模型和张量分解技术等，但是，当大量情境数据增加时，这些技术会因为情境集合维度过大而遭到严重的数据系稀疏问题。深度学习通过将各种类型的情境数据进行建模，并表示为一个低维、稠密的隐向量，能够有效缓解这种数据稀疏问题。

#### 5.2.1 多情境轨迹嵌入模型(Multi-Context Trajectory Embedding Model, MC-TEM)

- ###### Paper：

&emsp;&emsp;[37]

- ###### 基本思想：

&emsp;&emsp;将分布式表示模型用于情境信息建模，提出一种多情境轨迹嵌入模型(Multi-Context Trajectory Embedding Model, MC-TEM)，通过将包括用户、轨迹、临近的地点、类别、时间、区域在内的情境信息嵌入到一个统一的隐空间中，从而能够抓住多种类型的情境信息用于轨迹数据挖掘，此外，分布式表示模型通过刻画相关因素之间的距离以及联系，可以增加模型的可解释性。

#### 5.2.2 一种用于基于情境的引用推荐的神经概率模型

- ###### Paper：

&emsp;&emsp;[123]

- ###### 基本思想：

&emsp;&emsp;一种神经概率模型用于基于情境的引用推荐。首先用一系列词语的序列来表示情境，然后利用词分布式表示学习方法学习情境和文档的向量表示，最后通过神经概率模型联合情境和文档的向量表示来产生文章推荐。

#### 5.2.3 一种来解决情境感知的引用推荐问题的Enconder-Deconder结构

- ###### Paper：

&emsp;&emsp;[124]

- ###### 基本思想：

&emsp;&emsp;一种 Enconder-Deconder结构来解决情境感知的引用推荐问题，在解码器中，作者采用了一个基于CNN的深度模型来学习情境数据的隐表示，在解码器中， 作者利用一个RNN来生成引用的文章标题，同时利用作者的元数据构建了一个作者网络来抓住作者的自身偏好，同时采用Attention机制抓住不同部分输入对生成文章标题的重要性。

#### 5.2.4  改进

- ###### Paper：

&emsp;&emsp;[125]

- ###### 基本思想：

&emsp;&emsp;将情境信息分为清晰情境信息和隐情境信息，首先采用 深度自编码器从各种类型的、粗糙的情境数据中提取隐情境表示，然后采用隐因子模型融合隐情境表 示、清晰的情境信息和用户对项目评分数据构建一个评分模型来进行评分预测，通过融入隐情境信息 提升了推荐系统的质量。

#### 5.2.5 融合用户情境信息的图像标签推荐

- ###### Paper：

&emsp;&emsp;[72]

- ###### 基本思想：

&emsp;&emsp;利用深度神经网络模型研究了融合用户情境信息的图像标签推荐问题，同时考虑了用户情境信息和图像语义信息。主要思路是采用深度卷积神经网络学习图像的语义表示，采用一个深度神经网络学习用户的情境表示，最后联合两方面的表示，将标签推荐问题作为一个多标记分类问题进行标签推荐。 

<br>

&emsp;&emsp;总的来说，在情境感知的推荐系统中，深度学习能够用于情境信息的有效建模。一方面，在很对 复杂推荐场景中，通过深度学习方法能够有效融入 情境信息到推荐系统中;另一方面，深度学习通过 挖掘各类情境数据来获取情境信息的隐表示，并在 此基础上进行情境感知的推荐，能够有效融入各类 粗糙的情境数据，缓解情境感知的推荐系统中的数 据稀疏问题。但同时，由于情境数据被表示为隐情境，模型面临可解释性不足等诸多问题。

<br>

## 6. 总结比较

&emsp;&emsp;基于深度学习的推荐方法能够融入多源异构数据进行推荐，包括**用户的显式反馈(评分、喜欢 \不喜欢)或隐式反馈数据(浏览、点击等行为数据)、 用户画像(性别、年龄、喜好等)和项目内容(文本、图像等描述或内容)数据、用户生成内容(社会化关系、标注、评论等辅助数据)**等。

&emsp;&emsp;深度学习方法通过将多源异构数据作为输入从而采用一个端到端的模式自动训练预测模型，能够有效融入多源异构数据到推荐系统中，从而缓解传统推荐系统中面临的数据稀疏和冷启动问题，并提升推荐系统的能力。

&emsp;&emsp;其主要的优势是:

&emsp;&emsp;(1)可以避免复杂人工特征工程，尤其是面对图像、视频等非结构化数据，深度学习的表示学习能力能够帮助从非结构化数据中提取内容信息;

&emsp;&emsp;(2)可以学习非线性的多层次抽象特征表示，而且获取的特征通常是稠密和低维的，这是传统浅层模型所不具备的;

&emsp;&emsp;(3)可以克服不同数据之间的异构性， 将各类粗糙的原始数据作为输入来学习用户和项目的隐表示。

&emsp;&emsp;但同时也存在一些不足:

&emsp;&emsp;(1) 可扩展性问题。当前，虽然深度学习在Youtube视频推荐、Google的App推荐和Yahoo的新闻推荐等实际场景中得到了广泛应用，但由于其模型复杂往往需要长的训练时间，如何平衡模型可扩性和复杂度仍然是一个大的问题;

&emsp;&emsp;(2)深度学习模型往往类似于一个黑盒，容易带来推荐系统可解释性不足的问题，如何提升多源异构数据对于增强推荐能力的可解释性仍然有待深入研究。

&emsp;&emsp;总的来说，基于深度学习的推荐系统研究利用深度学习方法学习用户和项目的隐表示来进行项 目推荐，但是不同类型的方法在深度学习模型、数据类型以及推荐对象等方面存在着差异。

<br>

## 7. 展望

### 7.1 深度学习与现有推荐方法的结合

&emsp;&emsp;传统的推荐方法，包括基于内容的方法和协同过滤方法，都采用浅层模型进行预测，依赖于人工特征提取，很难有效学习到深层次的用户和项目隐表示。通过利用深度学习模型融合更多的多源异构数据，包括社会化关系、用户或项目属性以及用户的评论和标签信息等，能够学习到更加抽象、更加稠密的用户和项目的深层次表示，同时采用深层神经网络结构构建预测模型也能够更好地抓住用户和项目之间交互的非线性结构特征。同时，传统的推荐方法，具有简单、可解释性强等优势。因此，将深度学习与现有推荐方法结合，能够融合两种方法的优势，目前已经有相关研究开始出现，这个方向值得更多的研究者加以关注。

### 7.2 基于深度学习的跨领域信息融合的推荐

&emsp;&emsp;随着大规模数据获取能力的提升，用户在不同领域的历史记录或项目在不同领域的信息能够被获取。例如，一个用户可能在多个社交媒体平台上注册账号，融合用户在不同平台上的数据能够进行跨领域信息融合的推荐，帮助克服单一领域信息的不足，从而有效缓解传统推荐系统中的数据稀疏和冷启动问题，同时利用多个领域数据能够更好地发 现用户的个性化偏好。针对跨领域推荐问题的研究，当前最主要的研究方法包括基于协同过滤的方法、基于迁移学习的方法和基于张量分解的方法等。但是，这些方法都针对不同领域中特定类型的信息进行融合，适应性非常有限。当前，利用深度学习技术，通过将各类数据通过嵌入式表示等方法作为统一输入，构建深层预测模型能够有效融合各种不同类型的、跨平台的异构数据进行推荐，已经在Google和微软等互联网公司的实际系统中被应用。未来，通过构建深度学习模型来实现跨领域信息融合的推荐将是学术界和工业界研究的重点方向。

- ###### 相关文献：

- 基于协同过滤方法的跨领域推荐：

&emsp;&emsp;[125]()

- 基于迁移学习方法的跨领域推荐：

&emsp;&emsp;[128]()

- 基于张量分解方法的跨领域推荐：

&emsp;&emsp;[129]()

- ###### 相关应用：

- Google的应用：

&emsp;&emsp;[8]()

- 微软的应用：

&emsp;&emsp;[11]()

### 7.3 注意力机制与基于深度学习的推荐系统的结合

&emsp;&emsp;基于注意力机制的深度学习是人类视觉中的选择注意力机制与深度神经网络的结合，目前在计算机视觉、自然语言处理等领域取得了巨大成功。 当前，注意力机制已经被应用于MLP、RNN、CNN 和其他深度学习模型，其中最为引人关注的是基于注意力的RNN和基于注意力的CNN。基于注意力的 RNN能够更好地建模序列数据中的长期记忆，基于注意力的CNN能够从输入中识别与问题最具有信息量的部分。将注意力机制应用到在推荐系统中， 能够帮助推荐系统抓住项目中最具有信息量的特征，推荐最具有代表性的项目，同时增强模型的可解释性。当前，注意力机制已经在hashtag推荐，文章推荐，多媒体推荐，引用推荐等问题中得到了应用。但是总的来说，目前的研究还比较少，未来还需要更深入和更广泛的研究。

- ######  相关文献：

- 基于注意力的hashtag推荐：

&emsp;&emsp;[36]

&emsp;&emsp;[93]

&emsp;&emsp;[96]

&emsp;&emsp;[97]

- 基于注意力的文章推荐：

&emsp;&emsp;[95]

- 基于注意力的多媒体推荐：

&emsp;&emsp;[113]

- 基于注意力的引用推荐：

&emsp;&emsp;[124]

### 7.4 新的深度学习推荐系统架构

### 7.5 基于深度学习的推荐系统的可解释性


<br>
<br>
<br>


- ###### reference：

[基于深度学习的推荐系统_黄立威](http://kns.cnki.net/KCMS/detail/11.1826.TP.20171115.2242.004.html?uid=WEEvREcwSlJHSldRa1Fhb09jSnZqYVRISSs5a2N5MTVXeDVFdzgrR2VQTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!&v=MTQwNThMN1I3cWViK1pyRml2bFZMckFJbGM9THo3QmRyRzRIOWJOcm81QVpPc09ZdzlNem1SbjZqNTdUM2ZscVdNMENM)。4
