# 关联分析

<br>
<br>

&emsp;&emsp;关联分析又称关联挖掘，就是在交易数据、关系数据或其他信息载体中，查找存在于项目集合或对象集合之间的频繁模式、关联、相关性或因果结构。

&emsp;&emsp;或者说，关联分析是发现交易数据库中不同商品（项）之间的联系。

&emsp;&emsp;关联分析是一种简单、实用的分析技术，就是发现存在于大量数据集中的关联性或相关性，从而描述了一个事物中某些属性同时出现的规律和模式。

&emsp;&emsp;关联分析是从大量数据中发现项集之间有趣的关联和相关联系。关联分析的一个典型例子是购物篮分析。该过程通过发现顾客放人其购物篮中的不同商品之间的联系，分析顾客的购买习惯。通过了解哪些商品频繁地被顾客同时购买，这种关联的发现可以帮助零售商制定营销策略。其他的应用还包括价目表设计、商品促销、商品的排放和基于购买模式的顾客划分。

&emsp;&emsp;可从数据库中关联分析出形如“由于某些事件的发生而引起另外一些事件的发生”之类的规则。如“67%的顾客在购买啤酒的同时也会购买尿布”，因此通过合理的啤酒和尿布的货架摆放或捆绑销售可提高超市的服务质量和效益。又如“C语言课程优秀的同学，在学习‘数据结构’时为优秀的可能性达88%”，那么就可以通过强化“C语言”的学习来提高教学效果。

## 1. 关联分析中基本概念

&emsp;&emsp;定义：

&emsp;&emsp;1、事务：每一条交易称为一个事务，例如示例1中的数据集就包含四个事务。

&emsp;&emsp;2、项：交易的每一个物品称为一个项，例如Cola、Egg等。　

&emsp;&emsp;3、项集：包含零个或多个项的集合叫做项集，例如{Cola, Egg, Ham}。

&emsp;&emsp;4、k−项集：包含k个项的项集叫做k-项集，例如{Cola}叫做1-项集，{Cola, Egg}叫做2-项集。

&emsp;&emsp;5、支持度计数：一个项集出现在几个事务当中，它的支持度计数就是几。例如{Diaper, Beer}出现在事务 002、003和004中，所以它的支持度计数是3。

&emsp;&emsp;6、支持度：支持度计数除于总的事务数。例如上例中总的事务数为4，{Diaper, Beer}的支持度计数为3，所以它的支持度是3÷4=75%，说明有75%的人同时买了Diaper和Beer。

&emsp;&emsp;关联规则A->B的支持度support=P(AB)，指的是事件A和事件B同时发生的概率。

&emsp;&emsp;7、频繁项集：支持度大于或等于某个阈值的项集就叫做频繁项集。例如阈值设为50%时，因为{Diaper, Beer}的支持度是75%，所以它是频繁项集。

&emsp;&emsp;8、前件和后件：对于规则{Diaper}→{Beer}，{Diaper}叫做前件，{Beer}叫做后件。

&emsp;&emsp;9、置信度：对于规则{Diaper}→{Beer}，{Diaper, Beer}的支持度计数除于{Diaper}的支持度计数，为这个规则的置信度。例如规则{Diaper}→{Beer}的置信度为3÷3=100%。说明买了Diaper的人100%也买了Beer。

&emsp;&emsp;置信度confidence=P(B|A)=P(AB)/P(A),指的是发生事件A的基础上发生事件B的概率。

&emsp;&emsp;10、强关联规则：大于或等于最小支持度阈值和最小置信度阈值的规则叫做强关联规则。

&emsp;&emsp;关联分析的最终目标就是要找出强关联规则。

&emsp;&emsp;## 2. Apriori算法

&emsp;&emsp;电子商务中常用的一种数据挖掘方法就是从用户交易数据集中寻找商品之间的关联规则。关联规则中常用的一种算法是Apriori算法。该算法主要包含两个步骤：首先找出数据集中所有的频繁项集，这些项集出现的频繁性要大于或等于最小支持度；然后根据频繁项集产生强关联规则，这些规则必须满足最小支持度和最小置信度。

&emsp;&emsp;上面提到了最小支持度和最小置信度，事实上，在关联规则中用于度量规则质量的两个主要指标即为支持度和置信度。那么，什么是支持度和置信度呢？接下来进行讲解。

&emsp;&emsp;给定关联规则X=>Y，即根据X推出Y。形式化定义为：

&emsp;&emsp;![](https://upload-images.jianshu.io/upload_images/5687393-8f2f2dd9b9067a70.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/689)

&emsp;&emsp;### 2.1 算法步骤

&emsp;&emsp;1.找出出现频率最大的一个项L1。

&emsp;&emsp;2.根据L1找频繁“2项集”的集合C2.

&emsp;&emsp;3.并剪掉不满足支持度阈值的项，得到L2。

&emsp;&emsp;4.根据L2找频繁“3项集”的集合C3。

&emsp;&emsp;假设D表示交易数据集；K为项集，即包含k个项的集合；Lk表示满足最小支持度的k项集；Ck表示候选k项集。Apriori算法的参考文献描述如下。在该算法中，候选集的计算过程如下所示：

&emsp;&emsp;![](https://upload-images.jianshu.io/upload_images/5687393-c0672f27cd732701.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/784)

&emsp;&emsp;例如: L2 = {{A,C},{B,C},{B,E}{C,E}}

&emsp;&emsp;那么 C3= {{A,B,C},{A,C,E},{B,C,E}}

&emsp;&emsp;5.根据性质和支持度阈值进行剪枝，得到L3。

&emsp;&emsp;Apriori性质：一个频繁项集的任一子集也应该是频繁项集。也就是，生成一个k-itemset的候选项时，如果这个候选项有子集不在(k-1)-itemset(已经确定是frequent的)中时，那么这个候选项就不用拿去和支持度判断了，直接删除。

&emsp;&emsp;![](https://upload-images.jianshu.io/upload_images/5687393-a7243fb7abcc38e8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/575)

&emsp;&emsp;6.循环上述过程，直到得到空集C，即直到不能发现更大的频集L。

&emsp;&emsp;7.计算最大频集L的非空子集，两两计算置信度，得到大于置信度阈值的强关联规则。


<br>
<br>
<br>
<br>

## Reference:

1. [推荐算法-关联分析（关联规则）](https://www.jianshu.com/p/469dff109fae)

2. [【机器学习实战】第11章 使用 Apriori 算法进行关联分析](https://www.jianshu.com/p/abc683a92418?utm_campaign=maleskine&utm_content=note&utm_medium=seo_notes&utm_source=recommendation)
